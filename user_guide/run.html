
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>How to use slack_transfer &#8212; slack_transfer 0.2.8 documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CLI" href="cli.html" />
    <link rel="prev" title="Environmental Settings" href="environment.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">slack_transfer 0.2.8 documentation</p>
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="index_ja.html">
  ユーザーガイド
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../reference/index.html">
  API reference
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="environment.html">
   Environmental Settings
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   How to use slack_transfer
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="cli.html">
   CLI
  </a>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview-and-definition-of-terms">
   0. Overview and definition of terms
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#caution">
   1. Caution
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#obtaining-slack-token-the-original-ws">
   2. Obtaining Slack token (the original WS)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#choice-a-if-you-choose-from-an-app-manifest">
     Choice A: If you choose “From an app manifest”
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#choice-b-if-you-choose-from-scratch">
     Choice B: If you choose “From scratch”
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scopes-required-on-the-original-ws-side">
     Scopes required on the original WS side
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#obtaining-slack-token-the-destination-ws">
   3. Obtaining Slack token (the destination WS)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#add-api-bot-to-private-channel-on-the-original-ws">
   4. Add API bot to Private channel on the original WS
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#considering-channel-name-mappings">
   5. Considering channel name mappings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#migrate-emojis">
   6. Migrate emojis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#migrate-data">
   7. Migrate data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-the-run-command-to-run-all-settings-from-the-cli">
     7-1. Use the run command to run all settings from the CLI
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-the-interactive-mode-to-proceed-with-all-settings-on-the-screen">
     7-2. Use the interactive mode to proceed with all settings on the screen
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#check-for-files-failed-to-upload">
   8. check for files failed to upload
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#faq">
   9. FAQ
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#not-in-channel-error-appears-during-uploading">
     not_in_channel error appears during uploading.
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="how-to-use-slack-transfer">
<h1>How to use slack_transfer<a class="headerlink" href="#how-to-use-slack-transfer" title="Permalink to this heading">#</a></h1>
<p>This explanation assumes that the <a class="reference internal" href="environment.html"><span class="doc">Environmental Settings</span></a> step has been completed.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>A notebook that can run on Google Colab is also provided: <a href="https://colab.research.google.com/github/masanorihirano/slack_transfer/blob/main/examples/slack_transfer.ipynb" target="_blank" rel="noopener"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"></a></p>
</div>
<section id="overview-and-definition-of-terms">
<h2>0. Overview and definition of terms<a class="headerlink" href="#overview-and-definition-of-terms" title="Permalink to this heading">#</a></h2>
<p>Using <code class="code docutils literal notranslate"><span class="pre">slack_transfer</span></code>, you can transfer data from the original Slack workspace to the destination Slack workspace.</p>
<p>Note that if the Slack trial is still available, you can temporarily activate it to retrieve all past data.</p>
<dl class="simple">
<dt>First, let us define the terms as follows</dt><dd><ul class="simple">
<li><p>WS: A slack workspace.</p></li>
<li><p>OrG: Slack OrG, which is applicable only if you have a subscription to the Enterprise grid. In most cases, you do not need to be aware of it, but there may be a special note about WS under the Enterprise grid.</p></li>
<li><p>Original WS: the WS from which the data is being migrated. Since data is downloaded from this WS, it is called the download side.the WS from which the data is being migrated. Since data is downloaded from this WS, it is called the download side.</p></li>
<li><p>Destination WS：the destination WS.</p></li>
<li><p>Terminal: the terminal you set up in <a class="reference internal" href="environment.html"><span class="doc">Environmental Settings</span></a>.</p></li>
</ul>
</dd>
</dl>
<p>If the original WS and the destination WS are switched, it will cause a major accident.
Thus, in this repository,  the two sides are explicitly separated, and the read/write privileges of the token are also set according to each role in order to avoid accidents.</p>
<p><code class="code docutils literal notranslate"><span class="pre">slack_transfer</span></code> run basically an all-in-one migration process.
Please be aware that, although we pay full attention, the migration process may not succeed in one shot due to the misbehavior of the slack server or potential bugs.
The following is what <code class="code docutils literal notranslate"><span class="pre">slack_transfer</span></code> does.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>┌─────────────┐                ┌────────────┐              ┌────────────────┐
│ Original WS │  --download-&gt;  │  Terminal  │  --upload-&gt;  │ Destination WS │
└─────────────┘                └────────────┘              └────────────────┘
</pre></div>
</div>
<p>Therefore, the terminal must have sufficient disk space to store the data of the original WS.
Generally, you do not need a large amount of disk space, but you may need a large amount of space depending on the size and volume of the attached files, since attached files to the original WS will be downloaded to the terminal.
If you are using a free plan of Slack, a warning will probably appear when uploading files in excess of 5 GB.
If you really want to check how much space you need, please go to <a class="reference internal" href="cli.html"><span class="doc">CLI</span></a> file_volume section for a rough estimate.</p>
<p>This user guide assumes that you have administrative privileges on both the downloading and uploading WSs，but, not limited to.</p>
</section>
<section id="caution">
<h2>1. Caution<a class="headerlink" href="#caution" title="Permalink to this heading">#</a></h2>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>This tool cannot give a complete migration. We are trying to migrate as much as possible, but there are some limitations due to the Slack API specifications. The following are not supported at this time:</dt><dd><ul>
<li><p>Migration of Slack connect channel (Please ask the original Slack connect provider to re-connect)</p></li>
<li><p>Maintaining foldering of bookmarks (not possible due to the Slack API).</p></li>
<li><p>When porting Slack post, there is a possibility of formatting corruption. Post will be read-only in the destination WS. (not possible due to the Slack API limitation).</p></li>
<li><p>Reactions are only ported once for each type as a reaction by the API (because the API only allows the bot to press the reaction emoji).</p></li>
<li><p>Possible formatting errors of massages having more than 3000 characters (Due to API restrictions, the message will be split into separate submissions.)</p></li>
<li><p>Uploading emoji (due to API limitations, downloading is possible, but uploading is not.)</p></li>
<li><p>Width is limited to 50% when multiple media, such as markdown and non-text items (panels), are included (due to API limitation)</p></li>
<li><p>Files larger than several MB may not be uploaded due to a bug in the Slack API. In particular, the threshold is often 10 MB or less for WSs under OrG, while general WSs may work with files as small as 200 MB. The file upload process may take an extremely long time due to retries and automatic attempts workarounds for this problem.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Usernames in “mention” are not converted. This is not only because it is complicated to specify user correspondence, but also because user information is automatically imported and reflected once connecting between the original and destination WS via Slack connect.</p></li>
<li><p>Since migrated messages are posted by the API, the timestamp is changed. Instead, the original timestamp is added at the end of the users’ name.</p></li>
<li><p>It is provided under the MIT license, and there is no warranty. (Only the built binary version is under the GPL3.0 license.)</p></li>
<li><p>Only Channel can be migrated; DM cannot.</p></li>
<li><p>Slack API output values (especially during download) are not precisely defined and may cause unexpected errors. We appreciate your cooperation in reporting potential bugs!</p></li>
</ul>
</div></blockquote>
<p>The tool is designed to avoid destructive operation as long as possible.</p>
<dl class="simple">
<dt>Changes that may be occurred on the original WS：</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>The Slack bot will unintentionally auto-join to all public channels by itself.</dt><dd><ul>
<li><p>When token_test is performed, the Slack bot will automatically join the default channel equivalent to “general” by itself.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>What users MUST do on the original WS:</dt><dd><ul class="simple">
<li><p>Add a bot to the private channel that you want to migrate with this tool.</p></li>
</ul>
</dd>
<dt>Changes that may be occurred on the destination WS：</dt><dd><ul class="simple">
<li><p>new channels creations, file uploads, bookmark additions, message post, pin creation, etc.</p></li>
<li><p>Changes performed on existing channels when the <code class="code docutils literal notranslate"><span class="pre">--override</span></code> flag is used: adding files, bookmarks, messages, changing the channel description and purpose, adding pins, etc.</p></li>
</ul>
</dd>
<dt>What users must do on the destination WS (=things that this tool does not do):</dt><dd><ul class="simple">
<li><p>Delete unnecessary channels</p></li>
<li><p>Deleting a channel when the migration fails and trying again (using <code class="code docutils literal notranslate"><span class="pre">--override</span></code> flag is an alternative option, but it can insert data twice).</p></li>
<li><p>make a public channel to a private channel if needed after the migration is complete</p></li>
<li><p>Add others to the channel as needed.</p></li>
</ul>
</dd>
</dl>
<p>Before migrating to the production environment, it is recommended to create a test WS and confirm that the migration is successful before migrating to the production environment.
If you have any problems, you can submit an issue on github ( <a href="https://github.com/masanorihirano/slack_transfer/issues" target="_blank" rel="noopener">https://github.com/masanorihirano/slack_transfer/issues</a> ), but we do not guarantee support or bug fixes.
Please be careful not to include any confidential information such as token information when submitting an issue.</p>
</section>
<section id="obtaining-slack-token-the-original-ws">
<span id="downloader-token"></span><h2>2. Obtaining Slack token (the original WS)<a class="headerlink" href="#obtaining-slack-token-the-original-ws" title="Permalink to this heading">#</a></h2>
<p>(1) First, go to <a href="https://api.slack.com/apps/" target="_blank" rel="noopener">https://api.slack.com/apps/</a></p>
<img alt="../_images/create-app-dl-01.png" src="../_images/create-app-dl-01.png" />
<hr class="docutils" />
<p>(2) Click “Create New App”.
You can choose either of the two options here, but selecting “From an app manifest” is recommended because it allows you to configure all the settings at once.</p>
<a class="reference internal image-reference" href="../_images/create-app-dl-02.png"><img alt="../_images/create-app-dl-02.png" src="../_images/create-app-dl-02.png" style="width: 452.9px; height: 296.09999999999997px;" /></a>
<section id="choice-a-if-you-choose-from-an-app-manifest">
<h3>Choice A: If you choose “From an app manifest”<a class="headerlink" href="#choice-a-if-you-choose-from-an-app-manifest" title="Permalink to this heading">#</a></h3>
<p>(3) Select the original workspace from Select a workspace.</p>
<a class="reference internal image-reference" href="../_images/create-app-dl-a-03.png"><img alt="../_images/create-app-dl-a-03.png" src="../_images/create-app-dl-a-03.png" style="width: 420.0px; height: 290.5px;" /></a>
<hr class="docutils" />
<p>(4) Go next,</p>
<a class="reference internal image-reference" href="../_images/create-app-dl-a-04.png"><img alt="../_images/create-app-dl-a-04.png" src="../_images/create-app-dl-a-04.png" style="width: 452.9px; height: 288.4px;" /></a>
<hr class="docutils" />
<p>(5) You will see a screen like this. Use the tabs in YAML and delete the code inside.
Then, copy and paste the contents following to the image.</p>
<a class="reference internal image-reference" href="../_images/create-app-dl-a-05.png"><img alt="../_images/create-app-dl-a-05.png" src="../_images/create-app-dl-a-05.png" style="width: 449.4px; height: 324.09999999999997px;" /></a>
<div class="highlight-yml notranslate"><div class="highlight"><pre><span></span>display_information:
  name: Downloader API
features:
  bot_user:
    display_name: Downloader API
    always_online: true
oauth_config:
  scopes:
    bot:
      - bookmarks:read
      - channels:history
      - channels:join
      - channels:read
      - emoji:read
      - files:read
      - groups:history
      - groups:read
      - users:read
settings:
  org_deploy_enabled: false
  socket_mode_enabled: false
  token_rotation_enabled: false
</pre></div>
</div>
<hr class="docutils" />
<p>(6) Go next,</p>
<a class="reference internal image-reference" href="../_images/create-app-dl-a-06.png"><img alt="../_images/create-app-dl-a-06.png" src="../_images/create-app-dl-a-06.png" style="width: 508.2px; height: 412.29999999999995px;" /></a>
<hr class="docutils" />
<p>(7) Review is requested. Also referring to <a class="reference internal" href="#scope-dl"><span class="std std-ref">Scopes required on the original WS side</span></a>.</p>
<a class="reference internal image-reference" href="../_images/create-app-dl-a-07.png"><img alt="../_images/create-app-dl-a-07.png" src="../_images/create-app-dl-a-07.png" style="width: 476.7px; height: 279.29999999999995px;" /></a>
<hr class="docutils" />
<p>(8) Click “Install to Workspace”.</p>
<img alt="../_images/create-app-dl-a-08.png" src="../_images/create-app-dl-a-08.png" />
<hr class="docutils" />
<p>(9) Permission is requested; so allow this</p>
<a class="reference internal image-reference" href="../_images/create-app-dl-a-09.png"><img alt="../_images/create-app-dl-a-09.png" src="../_images/create-app-dl-a-09.png" style="width: 357.7px; height: 350.0px;" /></a>
<hr class="docutils" />
<p>(10) When the screen returns, click “OAuth &amp; Permissions”.</p>
<img alt="../_images/create-app-dl-a-10.png" src="../_images/create-app-dl-a-10.png" />
<hr class="docutils" />
<p>(11) “Bot User OAuth Token” is the Token that you want this time. Make sure it starts with “xoxb-“.
Pressing the “COPY” button to copy it to the clipboard. You can paste it anywhere by pressing ctrl + V.</p>
<img alt="../_images/create-app-dl-a-11.png" src="../_images/create-app-dl-a-11.png" />
</section>
<section id="choice-b-if-you-choose-from-scratch">
<h3>Choice B: If you choose “From scratch”<a class="headerlink" href="#choice-b-if-you-choose-from-scratch" title="Permalink to this heading">#</a></h3>
<p>(3) You will be asked to select the name of the API and the workspace.</p>
<a class="reference internal image-reference" href="../_images/create-app-dl-a-03.png"><img alt="../_images/create-app-dl-a-03.png" src="../_images/create-app-dl-a-03.png" style="width: 420.0px; height: 290.5px;" /></a>
<hr class="docutils" />
<p>(4) Inputs, then go next,</p>
<a class="reference internal image-reference" href="../_images/create-app-dl-a-04.png"><img alt="../_images/create-app-dl-a-04.png" src="../_images/create-app-dl-a-04.png" style="width: 452.9px; height: 288.4px;" /></a>
<hr class="docutils" />
<p>(5) When the screen returns, click “OAuth &amp; Permissions”.</p>
<img alt="../_images/create-app-dl-a-10.png" src="../_images/create-app-dl-a-10.png" />
<hr class="docutils" />
<p>(6) Go down to “Bot Token Scopes”.
Then, select and add scopes by “Add permission by Scope or API method…” and “Add an OAuth Scope”.
Required scopes are listed in <a class="reference internal" href="#scope-dl"><span class="std std-ref">Scopes required on the original WS side</span></a>.
When all is complete, click the “Install to Workspace” button at the top.</p>
<img alt="../_images/create-app-dl-b-06.png" src="../_images/create-app-dl-b-06.png" />
<hr class="docutils" />
<p>(7) Click “Install to Workspace”.</p>
<img alt="../_images/create-app-dl-a-08.png" src="../_images/create-app-dl-a-08.png" />
<hr class="docutils" />
<p>(8) Permission is requested; so allow this</p>
<a class="reference internal image-reference" href="../_images/create-app-dl-a-09.png"><img alt="../_images/create-app-dl-a-09.png" src="../_images/create-app-dl-a-09.png" style="width: 357.7px; height: 350.0px;" /></a>
<hr class="docutils" />
<p>(9) When the screen returns, click “OAuth &amp; Permissions”.</p>
<img alt="../_images/create-app-dl-a-10.png" src="../_images/create-app-dl-a-10.png" />
<hr class="docutils" />
<p>(10) “Bot User OAuth Token” is the Token that you want this time. Make sure it starts with “xoxb-“.
Pressing the “COPY” button to copy it to the clipboard. You can paste it anywhere by pressing ctrl + V.</p>
<img alt="../_images/create-app-dl-a-11.png" src="../_images/create-app-dl-a-11.png" />
</section>
<section id="scopes-required-on-the-original-ws-side">
<span id="scope-dl"></span><h3>Scopes required on the original WS side<a class="headerlink" href="#scopes-required-on-the-original-ws-side" title="Permalink to this heading">#</a></h3>
<dl class="simple">
<dt>[Common in Download/Upload operation]</dt><dd><ul class="simple">
<li><p>channels:history</p></li>
<li><p>channels:join</p></li>
<li><p>channels:read</p></li>
<li><p>files:read</p></li>
<li><p>groups:history</p></li>
<li><p>groups:read</p></li>
</ul>
</dd>
<dt>[Only required for downloading operation]</dt><dd><ul class="simple">
<li><p>bookmarks:read</p></li>
<li><p>emoji:read</p></li>
<li><p>users:read</p></li>
</ul>
</dd>
</dl>
</section>
</section>
<section id="obtaining-slack-token-the-destination-ws">
<span id="uploader-token"></span><h2>3. Obtaining Slack token (the destination WS)<a class="headerlink" href="#obtaining-slack-token-the-destination-ws" title="Permalink to this heading">#</a></h2>
<p>Basically, the same operations as in the previous section are performed on the destination WS.</p>
<p>The API name should be easy to understand, such as Uploader API. Also, be careful that this is for the destination WS.</p>
<p>If a manifest file is used to create the file, use copy and paste the following contents.</p>
<div class="highlight-yml notranslate"><div class="highlight"><pre><span></span>display_information:
  name: Uploader API
features:
  bot_user:
    display_name: Uploader API
    always_online: true
oauth_config:
  scopes:
    bot:
      - bookmarks:write
      - channels:history
      - channels:join
      - channels:manage
      - channels:read
      - chat:write
      - chat:write.customize
      - files:read
      - files:write
      - groups:history
      - groups:read
      - pins:write
      - reactions:write
settings:
  org_deploy_enabled: false
  socket_mode_enabled: false
  token_rotation_enabled: false
</pre></div>
</div>
<p>Scopes required on the destination WS side is:</p>
<dl class="simple">
<dt>[Common in Download/Upload operation]</dt><dd><ul class="simple">
<li><p>channels:history</p></li>
<li><p>channels:join</p></li>
<li><p>channels:read</p></li>
<li><p>files:read</p></li>
<li><p>groups:history</p></li>
<li><p>groups:read</p></li>
</ul>
</dd>
<dt>[Only required for uploading operation]</dt><dd><ul class="simple">
<li><p>channels:manage</p></li>
<li><p>files:write</p></li>
<li><p>chat:write</p></li>
<li><p>chat:write.customize</p></li>
<li><p>pins:write</p></li>
<li><p>bookmarks:write</p></li>
<li><p>reaction:write</p></li>
</ul>
</dd>
</dl>
</section>
<section id="add-api-bot-to-private-channel-on-the-original-ws">
<span id="invite-private"></span><h2>4. Add API bot to Private channel on the original WS<a class="headerlink" href="#add-api-bot-to-private-channel-on-the-original-ws" title="Permalink to this heading">#</a></h2>
<p>(1) By default, the API cannot read private channels, so it performs the operations equivalent to inviting a user.
For public channels, it is possible to join a channel without an invitation, so no action is required.</p>
<a class="reference internal image-reference" href="../_images/add-api-to-private-01-b.png"><img alt="../_images/add-api-to-private-01-b.png" src="../_images/add-api-to-private-01-b.png" style="width: 327.0px; height: 348.0px;" /></a>
<hr class="docutils" />
<p>(2) From the left panel of Slack, select “Apps”.</p>
<a class="reference internal image-reference" href="../_images/add-api-to-private-02.png"><img alt="../_images/add-api-to-private-02.png" src="../_images/add-api-to-private-02.png" style="width: 702.8px; height: 364.7px;" /></a>
<hr class="docutils" />
<p>(3) Next, select Downloader API (created in section 2) from the list of applications that appear.</p>
<a class="reference internal image-reference" href="../_images/add-api-to-private-03.png"><img alt="../_images/add-api-to-private-03.png" src="../_images/add-api-to-private-03.png" style="width: 703.5px; height: 348.59999999999997px;" /></a>
<hr class="docutils" />
<p>(4) Open the menu by clicking on the arrow right to the user’s name.</p>
<a class="reference internal image-reference" href="../_images/add-api-to-private-04.png"><img alt="../_images/add-api-to-private-04.png" src="../_images/add-api-to-private-04.png" style="width: 436.09999999999997px; height: 350.0px;" /></a>
<hr class="docutils" />
<p>(5) In the menu, select “Add this app to a channel”.</p>
<a class="reference internal image-reference" href="../_images/add-api-to-private-05.png"><img alt="../_images/add-api-to-private-05.png" src="../_images/add-api-to-private-05.png" style="width: 384.29999999999995px; height: 164.5px;" /></a>
<hr class="docutils" />
<p>(6) Then, a screen for selecting a channel list will appear, and select the desired private channel.
In this example, only Public channel is shown, but you can select any private channel that you are a member of.
Public channels can be automatically joined by the API without any special work, so there is no need to add it to them.</p>
</section>
<section id="considering-channel-name-mappings">
<span id="channel-mappings"></span><h2>5. Considering channel name mappings<a class="headerlink" href="#considering-channel-name-mappings" title="Permalink to this heading">#</a></h2>
<p>The general channel (or the renamed channel) is treated specially and cannot be changed to private, nor can it be used for Slack connect.
Therefore, you should be cautious about putting data into the general (or equivalent) channel of a WS on the destination side.</p>
<p>In general, it is not recommended to transfer data from the general channel of the original WS to the general channel of the destination WS.</p>
<dl class="simple">
<dt>Otherwise, if a duplicate channel name already exists in the uploading WS, there are three options</dt><dd><ul class="simple">
<li><p>Add migrated messages to the end of the existing postings –&gt; In the following work, use the <code class="code docutils literal notranslate"><span class="pre">--override</span></code> flag, allow overwriting, or <code class="code docutils literal notranslate"><span class="pre">override=True</span></code>. In the Uploader side WS, please also add the Uploader API to the existing channel as in step 4.</p></li>
<li><p>Create a new channel by removing the existing one → Delete the channel first (if you want to keep it as an archive, rename the channel and then archive it).</p></li>
<li><p>Create a new channel as a separate channel → Set the channel mapping. The channel mapping is set by the optional argument described below.</p></li>
</ul>
</dd>
</dl>
<p>Based on these criteria, determine the mapping between the original channel and the new channel.</p>
</section>
<section id="migrate-emojis">
<span id="id1"></span><h2>6. Migrate emojis<a class="headerlink" href="#migrate-emojis" title="Permalink to this heading">#</a></h2>
<p><strong>When you are using interactive mode (described below in 7-2)　or binary (exe) version, skip this step because the guidance will appear automatically.</strong></p>
<p>If you do not migrate the emoji first, you will not be able to move some reactions in the later procedure described below.</p>
<p>If you do not have the original image data, you can use the download tool including in slack_transfer.</p>
<p>If the migration has been completed manually, no work is required here.</p>
<p>The emoji will be downloaded to the <code class="code docutils literal notranslate"><span class="pre">emojis</span></code> folder in the specified directory.
Upload and add emoji on the destination WS’s administration screen if necessary.</p>
<p>The method for downloading emoji via the CLI is as follows.</p>
<p>First, enter the python environment.
For Mac/Linux/WSL　(If you are not using a venv environment, skip this):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ . .venv/bin/activate
</pre></div>
</div>
<p>For Windows　(If you are not using a venv environment, skip this):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ . .venv<span class="se">\S</span>cripts<span class="se">\a</span>ctivate
</pre></div>
</div>
<p>Then,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ slack_transfer emoji --data_dir &lt;local_data_dir&gt; --downloader_token &lt;downloader_token&gt;
</pre></div>
</div>
<dl class="simple">
<dt>Here, the parameters are as follows.</dt><dd><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">&lt;local_data_dir&gt;</span></code>: The directory where the downloaded data will be temporarily stored in the terminal. It can be set as a relative or absolute directory. If it does not exist, it will be created automatically. If you cannot know how to set, please set <code class="code docutils literal notranslate"><span class="pre">local_data_dir</span></code>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&lt;downloader_token&gt;</span></code>: The API token for the original WS, obtained in 2. It starts with <cite>xoxb-</cite>.</p></li>
</ul>
</dd>
</dl>
<p>The emojis are stored in the folder <code class="code docutils literal notranslate"><span class="pre">&lt;local_data_dir&gt;/emojis</span></code>. Basically, if you import those file, the name is automatically set the same as the original.</p>
<p>There is a tool for migrating emoji ( <a class="reference external" href="https://github.com/smashwilson/slack-emojinator">https://github.com/smashwilson/slack-emojinator</a> ), but we do not recommend it here because there is no guarantee that it can be done properly, and it uses a unofficial Slack API.</p>
<p>When your destination WS is under OrG, please note that emoji may conflict or be inappropriate for WS under OrG, since emojis are common to all WS in OrG.</p>
</section>
<section id="migrate-data">
<h2>7. Migrate data<a class="headerlink" href="#migrate-data" title="Permalink to this heading">#</a></h2>
<p><strong>If you are using the binary (exe) version, you can skip reading this section.</strong></p>
<p>After all preparations are finished, it is time to start the data migration.</p>
<dl class="simple">
<dt>The approximate time required is</dt><dd><ul class="simple">
<li><p>Download: 3M/100 seconds + file download time</p></li>
<li><p>Upload is in the order of M seconds + file upload time</p></li>
</ul>
</dd>
</dl>
<p>where M is the number of messages.</p>
<p>Usually, uploading requires a lot of time.
This is due the limit of the Slack API, so parallelization using the CLI is not recommended.</p>
<p>If M is large, it is recommended that the following work is performed only when the operation can be kept for a long period of time.
This tool also supports individual channel migration using the CLI, so please consider the option as well.</p>
<p>Now, let’s migrate actually.</p>
<p>First, if you are using venv, enter venv.</p>
<p>Mac/Linux/WSL (If you are not using a venv environment, skip this):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ . .venv/bin/activate
</pre></div>
</div>
<p>Windows (If you are not using a venv environment, skip this):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ . .venv<span class="se">\S</span>cripts<span class="se">\a</span>ctivate
</pre></div>
</div>
<dl class="simple">
<dt>There are two way to operate the following procedures</dt><dd><ol class="arabic simple">
<li><p>use the run command to run all settings from the CLI.</p></li>
<li><p>use the interactive mode to proceed with all settings on the screen.</p></li>
</ol>
</dd>
</dl>
<p>Either one can be used, but in rare cases, the second one may not work depending on your terminal environment.
(The default python for Mac does not work with the interactive mode.)</p>
<section id="use-the-run-command-to-run-all-settings-from-the-cli">
<h3>7-1. Use the run command to run all settings from the CLI<a class="headerlink" href="#use-the-run-command-to-run-all-settings-from-the-cli" title="Permalink to this heading">#</a></h3>
<p>Carry out:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ slack_transfer　run --data_dir<span class="o">=</span>&lt;local_data_dir&gt; --downloader_token<span class="o">=</span>&lt;downloader_token&gt; --uploader_token<span class="o">=</span>&lt;uploader_token&gt; --channel_names<span class="o">=</span>&lt;channel_names&gt; --name_mappings<span class="o">=</span>&lt;name_mappings&gt; <span class="o">[</span>--override<span class="o">]</span> <span class="o">[</span>--skip_bookmarks<span class="o">]</span>
</pre></div>
</div>
<p>If <code class="code docutils literal notranslate"><span class="pre">slack_transfer</span></code> is not available, you can use <code class="code docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">slack_transfer.run</span></code> instead.</p>
<dl class="simple">
<dt>The parameters are as follows.</dt><dd><ul class="simple">
<li><p><code class="code docutils literal notranslate"><span class="pre">&lt;local_data_dir&gt;</span></code>: The directory where the downloaded data will be temporarily stored in the terminal. It can be set as a relative or absolute directory. If it does not exist, it will be created automatically. If you cannot know how to set, please set <code class="code docutils literal notranslate"><span class="pre">local_data_dir</span></code>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&lt;downloader_token&gt;</span></code>: The API token for the original WS, obtained in 2. It starts with <cite>xoxb-</cite>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&lt;uploader_token&gt;</span></code>: The API token for the destination WS, obtained in 3. It starts with <cite>xoxb-</cite>.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&lt;channel_names&gt;</span></code>: The names of the channels to be processed. These are comma-separated names of the channels on the original WS. If you want to target all channels, delete <code class="code docutils literal notranslate"><span class="pre">--channel_names=&lt;channel_names&gt;</span></code> entirely.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">&lt;name_mappings&gt;</span></code>: Sets the channel name mappings determined in 4. If you don’t need it, remove <code class="code docutils literal notranslate"><span class="pre">&lt;code:`&lt;name_mappings&gt;</span></code> entirely. It is sufficient to specify only the channel names that need to be mapped. (If you want to use the same name as it is, leave it blank.) For example, it can be set like <code class="code docutils literal notranslate"><span class="pre">old_name1:new_name1,old_name2:new_name2</span></code> where old_name is the channel name on the original WS and new_name is the channel name on the destination WS</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">--override</span></code>:If you selected “Add to the end of the previous posts as is” in  4, please add this flag. Remove it if it is not needed.</p></li>
<li><p><code class="code docutils literal notranslate"><span class="pre">--skip_bookmarks</span></code>: Remove this flag if the bookmark is also to be migrated.</p></li>
</ul>
</dd>
</dl>
<p>For other detailed arguments, see <a class="reference internal" href="../reference/generated/other/slack_transfer.run.run.html"><span class="doc">slack_transfer.run.run</span></a>.</p>
<p>Taken together, the example command to be executed looks like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ slack_transfer　run --data_dir<span class="o">=</span>local_data_dir --downloader_token<span class="o">=</span>xoxb-00000000000-0000000000000-xxxxxxxxxxxxxxxxxxxxxxxx --uploader_token<span class="o">=</span>xoxb-0000000000000-0000000000000-xxxxxxxxxxxxxxxxxxxxxxxx --override --name_mappings<span class="o">=</span>general:_general,random:_random
</pre></div>
</div>
</section>
<section id="use-the-interactive-mode-to-proceed-with-all-settings-on-the-screen">
<h3>7-2. Use the interactive mode to proceed with all settings on the screen<a class="headerlink" href="#use-the-interactive-mode-to-proceed-with-all-settings-on-the-screen" title="Permalink to this heading">#</a></h3>
<p>Starts program by:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ slack_transfer　interactive
</pre></div>
</div>
<p>Then, follow the instructions.</p>
</section>
</section>
<section id="check-for-files-failed-to-upload">
<h2>8. check for files failed to upload<a class="headerlink" href="#check-for-files-failed-to-upload" title="Permalink to this heading">#</a></h2>
<p>A list of files that failed to upload is written under <code class="code docutils literal notranslate"><span class="pre">&lt;local_data_dir&gt;/file_upload_failure.txt</span></code>. If necessary, save the file in a different location.</p>
</section>
<section id="faq">
<h2>9. FAQ<a class="headerlink" href="#faq" title="Permalink to this heading">#</a></h2>
<section id="not-in-channel-error-appears-during-uploading">
<h3>not_in_channel error appears during uploading.<a class="headerlink" href="#not-in-channel-error-appears-during-uploading" title="Permalink to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">slack_sdk</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">SlackApiError</span><span class="p">:</span> <span class="n">The</span> <span class="n">request</span> <span class="n">to</span> <span class="n">the</span> <span class="n">Slack</span> <span class="n">API</span> <span class="n">failed</span><span class="o">.</span> <span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">slack</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">conversations</span><span class="o">.</span><span class="n">history</span><span class="p">)</span>
<span class="n">The</span> <span class="n">server</span> <span class="n">responded</span> <span class="k">with</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;ok&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;error&#39;</span><span class="p">:</span> <span class="s1">&#39;not_in_channel&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>If you get such an error, the channel name mapping in step 5 is incorrectly set and there is a duplication with an existing channel.
Either set the name mapping to avoid duplication, or add the Uploader API to the channel if you are adding to an existing channel.
See section 5 for details.</p>
</section>
</section>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="environment.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Environmental Settings</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="cli.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">CLI</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, Masanori HIRANO.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>